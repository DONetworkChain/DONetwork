//-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
// http://en.wikipedia.org/wiki/SHA-3
// wrapper for SHA3_256 for module of GNU/Linux kernel written by Jeff Garzik <jeff@garzik.org> from https://lwn.net/Articles/518415/
// Alexey Potehin <gnuplanet@gmail.com>, http://www.gnuplanet.ru/doc/cv
//-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
#ifndef SHA3_256_HPP_INCLUDE
#define SHA3_256_HPP_INCLUDE
//-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
#include <stdint.h>
#include "utils/sha3.h"
//-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
class sha3_256_t
{
public:
	typedef uint8_t sha3_256_item_t[SHA3_256_DIGEST_SIZE];

	sha3_256_t();
	void open(sha3_256_item_t *psha3_256_item);
	void update(const void * const p, uint64_t size);
	void close();

private:
	struct sha3_state ctx;
	sha3_256_item_t *psha3_256_item;
};
//-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
#endif
